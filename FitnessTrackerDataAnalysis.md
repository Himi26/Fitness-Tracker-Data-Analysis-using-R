## Fitness Tracker Usage Analysis with R

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/download.jpg)

### Introduction

Bellabeat, a high-tech manufacturer of health-focusedproducts for women.
Collecting data on activity, sleep, stress, and reproductive health has
allowed Bellabeat to empower women with knowledge about their own health
and habits.

Bellabeat offers health-focused products for women like Bellabeat app,
Leaf, Time, Spring and Bellabeat membership. This case study focus on
one of Bellabeat’s products i.e. the Bellabeat app, which provides users
with health data related to their activity, sleep, stress, menstrual
cycle, and mindfulness habits. This data can help users better
understand their current habits and make healthy decisions. The
Bellabeat app connects to its line of smart wellness products.

Analysing non-Bellabeat smart device data can help to gain insight into
how consumers are using their smart devices. The insights discovered and
recommendations will help guide marketing strategy for the company.

### Business task

To analyses smart device data to gain insight into how consumers are
using their smart devices focused on one of Bellabeat’s products
i.e. Bellabeat App . This analysis focus to answer the key business
questions like:

1.  What are some trends in smart device usage?
2.  How could these trends apply to Bellabeat customers?
3.  How could these trends help influence Bellabeat marketing strategy?

### Data Description

In this case study Public data from Kaggle called FitBit Fitness Tracker
Data that explores smart device users’ daily habits is used. These
datasets were generated by respondents to a distributed survey via
Amazon Mechanical Turk between 03.12.2016-05.12.2016.

This Kaggle dataset comprises personal fitness tracker data from thirty
Fitbit users who shared minute-level information on physical activity,
heart rate, and sleep monitoring. The dataset encompasses details about
daily activity, steps, and heart rate, providing an opportunity to delve
into users’ habits.

#### Installing the package and load the libraries

    #Install and Load library

    #install.packages('cowplot')
    #install.packages("plotly")
    #install.packages("vroom")
    #install.packages(c("ggplot2", "ggpubr"))
    library(ggplot2)
    library(ggpubr)
    library(tidyverse)

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ lubridate 1.9.3     ✔ tibble    3.2.1
    ## ✔ purrr     1.0.2     ✔ tidyr     1.3.0
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

    library(lubridate)
    library(cowplot)

    ## 
    ## Attaching package: 'cowplot'
    ## 
    ## The following object is masked from 'package:lubridate':
    ## 
    ##     stamp
    ## 
    ## The following object is masked from 'package:ggpubr':
    ## 
    ##     get_legend

    library(dplyr)
    library(plotly)

    ## 
    ## Attaching package: 'plotly'
    ## 
    ## The following object is masked from 'package:ggplot2':
    ## 
    ##     last_plot
    ## 
    ## The following object is masked from 'package:stats':
    ## 
    ##     filter
    ## 
    ## The following object is masked from 'package:graphics':
    ## 
    ##     layout

    library(vroom)

    ## 
    ## Attaching package: 'vroom'
    ## 
    ## The following objects are masked from 'package:readr':
    ## 
    ##     as.col_spec, col_character, col_date, col_datetime, col_double,
    ##     col_factor, col_guess, col_integer, col_logical, col_number,
    ##     col_skip, col_time, cols, cols_condense, cols_only, date_names,
    ##     date_names_lang, date_names_langs, default_locale, fwf_cols,
    ##     fwf_empty, fwf_positions, fwf_widths, locale, output_column,
    ##     problems, spec

#### Loading the dataset

    #Read csv file and load to dataframe

    daily_activity <- read.csv("dailyActivity_merged.csv")
    sleep_day <- read.csv("sleepDay_merged.csv")
    weight_log <- read.csv("weightLogInfo_merged.csv")
    daily_calories <- read_csv("dailyCalories_merged.csv")

    ## Rows: 940 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityDay
    ## dbl (2): Id, Calories
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    daily_intensities <- read_csv("dailyIntensities_merged.csv")

    ## Rows: 940 Columns: 10
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityDay
    ## dbl (9): Id, SedentaryMinutes, LightlyActiveMinutes, FairlyActiveMinutes, Ve...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    daily_steps <- read_csv("dailySteps_merged.csv")

    ## Rows: 940 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityDay
    ## dbl (2): Id, StepTotal
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    hourly_calories <- read_csv("hourlyCalories_merged.csv")

    ## Rows: 22099 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityHour
    ## dbl (2): Id, Calories
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    hourly_intensity <- read_csv("hourlyIntensities_merged.csv")

    ## Rows: 22099 Columns: 4
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityHour
    ## dbl (3): Id, TotalIntensity, AverageIntensity
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    hourly_steps <- read_csv("hourlySteps_merged.csv")

    ## Rows: 22099 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityHour
    ## dbl (2): Id, StepTotal
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    heart_rate_data <- read_csv("heartrate_seconds_merged.csv")

    ## Rows: 2483658 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Time
    ## dbl (2): Id, Value
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_calories_long <- read_csv("minuteCaloriesNarrow_merged.csv")

    ## Rows: 1325580 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityMinute
    ## dbl (2): Id, Calories
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_calories_wide <- read_csv("minuteCaloriesWide_merged.csv")

    ## Rows: 21645 Columns: 62
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr  (1): ActivityHour
    ## dbl (61): Id, Calories00, Calories01, Calories02, Calories03, Calories04, Ca...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_intensities_long <- read_csv("minuteIntensitiesNarrow_merged.csv")

    ## Rows: 1325580 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityMinute
    ## dbl (2): Id, Intensity
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_intensities_wide <- read_csv("minuteIntensitiesWide_merged.csv")

    ## Rows: 21645 Columns: 62
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr  (1): ActivityHour
    ## dbl (61): Id, Intensity00, Intensity01, Intensity02, Intensity03, Intensity0...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_METs <- read_csv("minuteMETsNarrow_merged.csv")

    ## Rows: 1325580 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityMinute
    ## dbl (2): Id, METs
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_sleep <- read_csv("minuteSleep_merged.csv")

    ## Rows: 188521 Columns: 4
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (3): Id, value, logId
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_steps_long <- read_csv("minuteStepsNarrow_merged.csv")

    ## Rows: 1325580 Columns: 3
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): ActivityMinute
    ## dbl (2): Id, Steps
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    minute_steps_wide <- read_csv("minuteStepsWide_merged.csv")

    ## Rows: 21645 Columns: 62
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr  (1): ActivityHour
    ## dbl (61): Id, Steps00, Steps01, Steps02, Steps03, Steps04, Steps05, Steps06,...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Data Review

    #Preview of the dataframe

    head(daily_activity)

    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ## 1 1503960366    4/12/2016      13162          8.50            8.50
    ## 2 1503960366    4/13/2016      10735          6.97            6.97
    ## 3 1503960366    4/14/2016      10460          6.74            6.74
    ## 4 1503960366    4/15/2016       9762          6.28            6.28
    ## 5 1503960366    4/16/2016      12669          8.16            8.16
    ## 6 1503960366    4/17/2016       9705          6.48            6.48
    ##   LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance
    ## 1                        0               1.88                     0.55
    ## 2                        0               1.57                     0.69
    ## 3                        0               2.44                     0.40
    ## 4                        0               2.14                     1.26
    ## 5                        0               2.71                     0.41
    ## 6                        0               3.19                     0.78
    ##   LightActiveDistance SedentaryActiveDistance VeryActiveMinutes
    ## 1                6.06                       0                25
    ## 2                4.71                       0                21
    ## 3                3.91                       0                30
    ## 4                2.83                       0                29
    ## 5                5.04                       0                36
    ## 6                2.51                       0                38
    ##   FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories
    ## 1                  13                  328              728     1985
    ## 2                  19                  217              776     1797
    ## 3                  11                  181             1218     1776
    ## 4                  34                  209              726     1745
    ## 5                  10                  221              773     1863
    ## 6                  20                  164              539     1728

    head(sleep_day)

    ##           Id              SleepDay TotalSleepRecords TotalMinutesAsleep
    ## 1 1503960366 4/12/2016 12:00:00 AM                 1                327
    ## 2 1503960366 4/13/2016 12:00:00 AM                 2                384
    ## 3 1503960366 4/15/2016 12:00:00 AM                 1                412
    ## 4 1503960366 4/16/2016 12:00:00 AM                 2                340
    ## 5 1503960366 4/17/2016 12:00:00 AM                 1                700
    ## 6 1503960366 4/19/2016 12:00:00 AM                 1                304
    ##   TotalTimeInBed
    ## 1            346
    ## 2            407
    ## 3            442
    ## 4            367
    ## 5            712
    ## 6            320

    head(weight_log)

    ##           Id                  Date WeightKg WeightPounds Fat   BMI
    ## 1 1503960366  5/2/2016 11:59:59 PM     52.6     115.9631  22 22.65
    ## 2 1503960366  5/3/2016 11:59:59 PM     52.6     115.9631  NA 22.65
    ## 3 1927972279  4/13/2016 1:08:52 AM    133.5     294.3171  NA 47.54
    ## 4 2873212765 4/21/2016 11:59:59 PM     56.7     125.0021  NA 21.45
    ## 5 2873212765 5/12/2016 11:59:59 PM     57.3     126.3249  NA 21.69
    ## 6 4319703577 4/17/2016 11:59:59 PM     72.4     159.6147  25 27.45
    ##   IsManualReport        LogId
    ## 1           True 1.462234e+12
    ## 2           True 1.462320e+12
    ## 3          False 1.460510e+12
    ## 4           True 1.461283e+12
    ## 5           True 1.463098e+12
    ## 6           True 1.460938e+12

    head(daily_calories)

    ## # A tibble: 6 × 3
    ##           Id ActivityDay Calories
    ##        <dbl> <chr>          <dbl>
    ## 1 1503960366 4/12/2016       1985
    ## 2 1503960366 4/13/2016       1797
    ## 3 1503960366 4/14/2016       1776
    ## 4 1503960366 4/15/2016       1745
    ## 5 1503960366 4/16/2016       1863
    ## 6 1503960366 4/17/2016       1728

    head(daily_intensities)

    ## # A tibble: 6 × 10
    ##         Id ActivityDay SedentaryMinutes LightlyActiveMinutes FairlyActiveMinutes
    ##      <dbl> <chr>                  <dbl>                <dbl>               <dbl>
    ## 1   1.50e9 4/12/2016                728                  328                  13
    ## 2   1.50e9 4/13/2016                776                  217                  19
    ## 3   1.50e9 4/14/2016               1218                  181                  11
    ## 4   1.50e9 4/15/2016                726                  209                  34
    ## 5   1.50e9 4/16/2016                773                  221                  10
    ## 6   1.50e9 4/17/2016                539                  164                  20
    ## # ℹ 5 more variables: VeryActiveMinutes <dbl>, SedentaryActiveDistance <dbl>,
    ## #   LightActiveDistance <dbl>, ModeratelyActiveDistance <dbl>,
    ## #   VeryActiveDistance <dbl>

    head(daily_steps)

    ## # A tibble: 6 × 3
    ##           Id ActivityDay StepTotal
    ##        <dbl> <chr>           <dbl>
    ## 1 1503960366 4/12/2016       13162
    ## 2 1503960366 4/13/2016       10735
    ## 3 1503960366 4/14/2016       10460
    ## 4 1503960366 4/15/2016        9762
    ## 5 1503960366 4/16/2016       12669
    ## 6 1503960366 4/17/2016        9705

    head(hourly_calories)

    ## # A tibble: 6 × 3
    ##           Id ActivityHour          Calories
    ##        <dbl> <chr>                    <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM       81
    ## 2 1503960366 4/12/2016 1:00:00 AM        61
    ## 3 1503960366 4/12/2016 2:00:00 AM        59
    ## 4 1503960366 4/12/2016 3:00:00 AM        47
    ## 5 1503960366 4/12/2016 4:00:00 AM        48
    ## 6 1503960366 4/12/2016 5:00:00 AM        48

    head(hourly_intensity)

    ## # A tibble: 6 × 4
    ##           Id ActivityHour          TotalIntensity AverageIntensity
    ##        <dbl> <chr>                          <dbl>            <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM             20            0.333
    ## 2 1503960366 4/12/2016 1:00:00 AM               8            0.133
    ## 3 1503960366 4/12/2016 2:00:00 AM               7            0.117
    ## 4 1503960366 4/12/2016 3:00:00 AM               0            0    
    ## 5 1503960366 4/12/2016 4:00:00 AM               0            0    
    ## 6 1503960366 4/12/2016 5:00:00 AM               0            0

    head(hourly_steps)

    ## # A tibble: 6 × 3
    ##           Id ActivityHour          StepTotal
    ##        <dbl> <chr>                     <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM       373
    ## 2 1503960366 4/12/2016 1:00:00 AM        160
    ## 3 1503960366 4/12/2016 2:00:00 AM        151
    ## 4 1503960366 4/12/2016 3:00:00 AM          0
    ## 5 1503960366 4/12/2016 4:00:00 AM          0
    ## 6 1503960366 4/12/2016 5:00:00 AM          0

    head(heart_rate_data)

    ## # A tibble: 6 × 3
    ##           Id Time                 Value
    ##        <dbl> <chr>                <dbl>
    ## 1 2022484408 4/12/2016 7:21:00 AM    97
    ## 2 2022484408 4/12/2016 7:21:05 AM   102
    ## 3 2022484408 4/12/2016 7:21:10 AM   105
    ## 4 2022484408 4/12/2016 7:21:20 AM   103
    ## 5 2022484408 4/12/2016 7:21:25 AM   101
    ## 6 2022484408 4/12/2016 7:22:05 AM    95

    head(minute_calories_long )

    ## # A tibble: 6 × 3
    ##           Id ActivityMinute        Calories
    ##        <dbl> <chr>                    <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM    0.786
    ## 2 1503960366 4/12/2016 12:01:00 AM    0.786
    ## 3 1503960366 4/12/2016 12:02:00 AM    0.786
    ## 4 1503960366 4/12/2016 12:03:00 AM    0.786
    ## 5 1503960366 4/12/2016 12:04:00 AM    0.786
    ## 6 1503960366 4/12/2016 12:05:00 AM    0.944

    head(minute_calories_wide )

    ## # A tibble: 6 × 62
    ##           Id ActivityHour Calories00 Calories01 Calories02 Calories03 Calories04
    ##        <dbl> <chr>             <dbl>      <dbl>      <dbl>      <dbl>      <dbl>
    ## 1 1503960366 4/13/2016 1…      1.89       2.20       0.944      0.944      0.944
    ## 2 1503960366 4/13/2016 1…      0.786      0.786      0.786      0.786      0.944
    ## 3 1503960366 4/13/2016 2…      0.786      0.786      0.786      0.786      0.786
    ## 4 1503960366 4/13/2016 3…      0.786      0.786      0.786      0.786      0.786
    ## 5 1503960366 4/13/2016 4…      0.786      0.786      0.786      0.786      0.786
    ## 6 1503960366 4/13/2016 5…      0.786      0.786      0.786      0.786      0.786
    ## # ℹ 55 more variables: Calories05 <dbl>, Calories06 <dbl>, Calories07 <dbl>,
    ## #   Calories08 <dbl>, Calories09 <dbl>, Calories10 <dbl>, Calories11 <dbl>,
    ## #   Calories12 <dbl>, Calories13 <dbl>, Calories14 <dbl>, Calories15 <dbl>,
    ## #   Calories16 <dbl>, Calories17 <dbl>, Calories18 <dbl>, Calories19 <dbl>,
    ## #   Calories20 <dbl>, Calories21 <dbl>, Calories22 <dbl>, Calories23 <dbl>,
    ## #   Calories24 <dbl>, Calories25 <dbl>, Calories26 <dbl>, Calories27 <dbl>,
    ## #   Calories28 <dbl>, Calories29 <dbl>, Calories30 <dbl>, Calories31 <dbl>, …

    head(minute_intensities_long )

    ## # A tibble: 6 × 3
    ##           Id ActivityMinute        Intensity
    ##        <dbl> <chr>                     <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM         0
    ## 2 1503960366 4/12/2016 12:01:00 AM         0
    ## 3 1503960366 4/12/2016 12:02:00 AM         0
    ## 4 1503960366 4/12/2016 12:03:00 AM         0
    ## 5 1503960366 4/12/2016 12:04:00 AM         0
    ## 6 1503960366 4/12/2016 12:05:00 AM         0

    head(minute_intensities_wide )

    ## # A tibble: 6 × 62
    ##           Id ActivityHour        Intensity00 Intensity01 Intensity02 Intensity03
    ##        <dbl> <chr>                     <dbl>       <dbl>       <dbl>       <dbl>
    ## 1 1503960366 4/13/2016 12:00:00…           1           1           0           0
    ## 2 1503960366 4/13/2016 1:00:00 …           0           0           0           0
    ## 3 1503960366 4/13/2016 2:00:00 …           0           0           0           0
    ## 4 1503960366 4/13/2016 3:00:00 …           0           0           0           0
    ## 5 1503960366 4/13/2016 4:00:00 …           0           0           0           0
    ## 6 1503960366 4/13/2016 5:00:00 …           0           0           0           0
    ## # ℹ 56 more variables: Intensity04 <dbl>, Intensity05 <dbl>, Intensity06 <dbl>,
    ## #   Intensity07 <dbl>, Intensity08 <dbl>, Intensity09 <dbl>, Intensity10 <dbl>,
    ## #   Intensity11 <dbl>, Intensity12 <dbl>, Intensity13 <dbl>, Intensity14 <dbl>,
    ## #   Intensity15 <dbl>, Intensity16 <dbl>, Intensity17 <dbl>, Intensity18 <dbl>,
    ## #   Intensity19 <dbl>, Intensity20 <dbl>, Intensity21 <dbl>, Intensity22 <dbl>,
    ## #   Intensity23 <dbl>, Intensity24 <dbl>, Intensity25 <dbl>, Intensity26 <dbl>,
    ## #   Intensity27 <dbl>, Intensity28 <dbl>, Intensity29 <dbl>, …

    head(minute_METs )

    ## # A tibble: 6 × 3
    ##           Id ActivityMinute         METs
    ##        <dbl> <chr>                 <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM    10
    ## 2 1503960366 4/12/2016 12:01:00 AM    10
    ## 3 1503960366 4/12/2016 12:02:00 AM    10
    ## 4 1503960366 4/12/2016 12:03:00 AM    10
    ## 5 1503960366 4/12/2016 12:04:00 AM    10
    ## 6 1503960366 4/12/2016 12:05:00 AM    12

    head(minute_sleep )

    ## # A tibble: 6 × 4
    ##           Id date                 value       logId
    ##        <dbl> <chr>                <dbl>       <dbl>
    ## 1 1503960366 4/12/2016 2:47:30 AM     3 11380564589
    ## 2 1503960366 4/12/2016 2:48:30 AM     2 11380564589
    ## 3 1503960366 4/12/2016 2:49:30 AM     1 11380564589
    ## 4 1503960366 4/12/2016 2:50:30 AM     1 11380564589
    ## 5 1503960366 4/12/2016 2:51:30 AM     1 11380564589
    ## 6 1503960366 4/12/2016 2:52:30 AM     1 11380564589

    head(minute_steps_long )

    ## # A tibble: 6 × 3
    ##           Id ActivityMinute        Steps
    ##        <dbl> <chr>                 <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM     0
    ## 2 1503960366 4/12/2016 12:01:00 AM     0
    ## 3 1503960366 4/12/2016 12:02:00 AM     0
    ## 4 1503960366 4/12/2016 12:03:00 AM     0
    ## 5 1503960366 4/12/2016 12:04:00 AM     0
    ## 6 1503960366 4/12/2016 12:05:00 AM     0

    head(minute_steps_wide )

    ## # A tibble: 6 × 62
    ##          Id ActivityHour Steps00 Steps01 Steps02 Steps03 Steps04 Steps05 Steps06
    ##       <dbl> <chr>          <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ## 1    1.50e9 4/13/2016 1…       4      16       0       0       0       9       0
    ## 2    1.50e9 4/13/2016 1…       0       0       0       0       0       0       0
    ## 3    1.50e9 4/13/2016 2…       0       0       0       0       0       0       0
    ## 4    1.50e9 4/13/2016 3…       0       0       0       0       0       0       0
    ## 5    1.50e9 4/13/2016 4…       0       0       0       0       0       0       0
    ## 6    1.50e9 4/13/2016 5…       0       0       0       0       0       0       0
    ## # ℹ 53 more variables: Steps07 <dbl>, Steps08 <dbl>, Steps09 <dbl>,
    ## #   Steps10 <dbl>, Steps11 <dbl>, Steps12 <dbl>, Steps13 <dbl>, Steps14 <dbl>,
    ## #   Steps15 <dbl>, Steps16 <dbl>, Steps17 <dbl>, Steps18 <dbl>, Steps19 <dbl>,
    ## #   Steps20 <dbl>, Steps21 <dbl>, Steps22 <dbl>, Steps23 <dbl>, Steps24 <dbl>,
    ## #   Steps25 <dbl>, Steps26 <dbl>, Steps27 <dbl>, Steps28 <dbl>, Steps29 <dbl>,
    ## #   Steps30 <dbl>, Steps31 <dbl>, Steps32 <dbl>, Steps33 <dbl>, Steps34 <dbl>,
    ## #   Steps35 <dbl>, Steps36 <dbl>, Steps37 <dbl>, Steps38 <dbl>, …

    #Check for number of rows in each dataframe

    nrow(daily_activity)

    ## [1] 940

    nrow(sleep_day)

    ## [1] 413

    nrow(weight_log)

    ## [1] 67

    nrow(daily_calories)

    ## [1] 940

    nrow(daily_intensities)

    ## [1] 940

    nrow(daily_steps)

    ## [1] 940

    nrow(hourly_calories)

    ## [1] 22099

    nrow(hourly_intensity)

    ## [1] 22099

    nrow(hourly_steps)

    ## [1] 22099

    nrow(heart_rate_data)

    ## [1] 2483658

    nrow(minute_calories_long )

    ## [1] 1325580

    nrow(minute_calories_wide )

    ## [1] 21645

    nrow(minute_intensities_long )

    ## [1] 1325580

    nrow(minute_intensities_wide )

    ## [1] 21645

    nrow(minute_METs )

    ## [1] 1325580

    nrow(minute_sleep )

    ## [1] 188521

    nrow(minute_steps_long )

    ## [1] 1325580

    nrow(minute_steps_wide )

    ## [1] 21645

    #Check for number of unique users in each dataframe or dataset

    n_distinct(daily_activity$Id)

    ## [1] 33

    n_distinct(sleep_day$Id)

    ## [1] 24

    n_distinct(weight_log$Id)

    ## [1] 8

    n_distinct(daily_calories$Id)

    ## [1] 33

    n_distinct(daily_intensities$Id)

    ## [1] 33

    n_distinct(daily_steps$Id)

    ## [1] 33

    n_distinct(hourly_calories$Id)

    ## [1] 33

    n_distinct(hourly_intensity$Id)

    ## [1] 33

    n_distinct(hourly_steps$Id)

    ## [1] 33

    n_distinct(heart_rate_data$Id)

    ## [1] 14

    n_distinct(minute_calories_long$Id)

    ## [1] 33

    n_distinct(minute_calories_wide$Id)

    ## [1] 33

    n_distinct(minute_intensities_long$Id)

    ## [1] 33

    n_distinct(minute_intensities_wide$Id)

    ## [1] 33

    n_distinct(minute_METs$Id)

    ## [1] 33

    n_distinct(minute_sleep$Id)

    ## [1] 24

    n_distinct(minute_steps_long$Id)

    ## [1] 33

    n_distinct(minute_steps_wide$Id)

    ## [1] 33

After After reviewing the dataset, the following observations can be
made:

The dataset contains more users’ data for daily activity compared to
sleep data.

Weight and heart rate data have a lower representation with only 8 and
14 users, respectively, compared to the daily activity data. Drawing
comparisons with other data categories may introduce bias. so, we will
have to exclude this for further analysis.

The data for minutes, including calories, intensity, and sleep, as well
as hourly calories, intensity, and sleep, have been merged into daily
records for calories, intensity, and sleep.

Subsequently, all the daily data has been merged into a single daily
activity table.As a result, detailed minute-level data and individual
daily data is not required. However, for subsequent analysis, we will
retain the need for hourly steps and intensity data.

The absence of demographic information, such as gender and age, in a
limited dataset of 30 users raises concerns about potential sampling
bias. It becomes uncertain if the sample accurately represents the
entire population.

### Data Cleaning

    #Checking for null value

    is.null(daily_activity)

    ## [1] FALSE

    is.null(sleep_day)

    ## [1] FALSE

    is.null(hourly_intensity)

    ## [1] FALSE

    is.null(hourly_steps)

    ## [1] FALSE

    #Checking for duplicate value

    sum(duplicated(daily_activity))

    ## [1] 0

    sum(duplicated(sleep_day))

    ## [1] 3

    sum(duplicated(hourly_intensity))

    ## [1] 0

    sum(duplicated(hourly_steps))

    ## [1] 0

    #Remove duplicate values

    sleep_day <- sleep_day %>% distinct()

    #Preview dataframe

    head(daily_activity)

    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ## 1 1503960366    4/12/2016      13162          8.50            8.50
    ## 2 1503960366    4/13/2016      10735          6.97            6.97
    ## 3 1503960366    4/14/2016      10460          6.74            6.74
    ## 4 1503960366    4/15/2016       9762          6.28            6.28
    ## 5 1503960366    4/16/2016      12669          8.16            8.16
    ## 6 1503960366    4/17/2016       9705          6.48            6.48
    ##   LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance
    ## 1                        0               1.88                     0.55
    ## 2                        0               1.57                     0.69
    ## 3                        0               2.44                     0.40
    ## 4                        0               2.14                     1.26
    ## 5                        0               2.71                     0.41
    ## 6                        0               3.19                     0.78
    ##   LightActiveDistance SedentaryActiveDistance VeryActiveMinutes
    ## 1                6.06                       0                25
    ## 2                4.71                       0                21
    ## 3                3.91                       0                30
    ## 4                2.83                       0                29
    ## 5                5.04                       0                36
    ## 6                2.51                       0                38
    ##   FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories
    ## 1                  13                  328              728     1985
    ## 2                  19                  217              776     1797
    ## 3                  11                  181             1218     1776
    ## 4                  34                  209              726     1745
    ## 5                  10                  221              773     1863
    ## 6                  20                  164              539     1728

    str(daily_activity)

    ## 'data.frame':    940 obs. of  15 variables:
    ##  $ Id                      : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...
    ##  $ ActivityDate            : chr  "4/12/2016" "4/13/2016" "4/14/2016" "4/15/2016" ...
    ##  $ TotalSteps              : int  13162 10735 10460 9762 12669 9705 13019 15506 10544 9819 ...
    ##  $ TotalDistance           : num  8.5 6.97 6.74 6.28 8.16 ...
    ##  $ TrackerDistance         : num  8.5 6.97 6.74 6.28 8.16 ...
    ##  $ LoggedActivitiesDistance: num  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ VeryActiveDistance      : num  1.88 1.57 2.44 2.14 2.71 ...
    ##  $ ModeratelyActiveDistance: num  0.55 0.69 0.4 1.26 0.41 ...
    ##  $ LightActiveDistance     : num  6.06 4.71 3.91 2.83 5.04 ...
    ##  $ SedentaryActiveDistance : num  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ VeryActiveMinutes       : int  25 21 30 29 36 38 42 50 28 19 ...
    ##  $ FairlyActiveMinutes     : int  13 19 11 34 10 20 16 31 12 8 ...
    ##  $ LightlyActiveMinutes    : int  328 217 181 209 221 164 233 264 205 211 ...
    ##  $ SedentaryMinutes        : int  728 776 1218 726 773 539 1149 775 818 838 ...
    ##  $ Calories                : int  1985 1797 1776 1745 1863 1728 1921 2035 1786 1775 ...

    head(sleep_day)

    ##           Id              SleepDay TotalSleepRecords TotalMinutesAsleep
    ## 1 1503960366 4/12/2016 12:00:00 AM                 1                327
    ## 2 1503960366 4/13/2016 12:00:00 AM                 2                384
    ## 3 1503960366 4/15/2016 12:00:00 AM                 1                412
    ## 4 1503960366 4/16/2016 12:00:00 AM                 2                340
    ## 5 1503960366 4/17/2016 12:00:00 AM                 1                700
    ## 6 1503960366 4/19/2016 12:00:00 AM                 1                304
    ##   TotalTimeInBed
    ## 1            346
    ## 2            407
    ## 3            442
    ## 4            367
    ## 5            712
    ## 6            320

    str(sleep_day)

    ## 'data.frame':    410 obs. of  5 variables:
    ##  $ Id                : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...
    ##  $ SleepDay          : chr  "4/12/2016 12:00:00 AM" "4/13/2016 12:00:00 AM" "4/15/2016 12:00:00 AM" "4/16/2016 12:00:00 AM" ...
    ##  $ TotalSleepRecords : int  1 2 1 2 1 1 1 1 1 1 ...
    ##  $ TotalMinutesAsleep: int  327 384 412 340 700 304 360 325 361 430 ...
    ##  $ TotalTimeInBed    : int  346 407 442 367 712 320 377 364 384 449 ...

    head(hourly_steps)

    ## # A tibble: 6 × 3
    ##           Id ActivityHour          StepTotal
    ##        <dbl> <chr>                     <dbl>
    ## 1 1503960366 4/12/2016 12:00:00 AM       373
    ## 2 1503960366 4/12/2016 1:00:00 AM        160
    ## 3 1503960366 4/12/2016 2:00:00 AM        151
    ## 4 1503960366 4/12/2016 3:00:00 AM          0
    ## 5 1503960366 4/12/2016 4:00:00 AM          0
    ## 6 1503960366 4/12/2016 5:00:00 AM          0

    str(hourly_steps)

    ## spc_tbl_ [22,099 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
    ##  $ Id          : num [1:22099] 1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...
    ##  $ ActivityHour: chr [1:22099] "4/12/2016 12:00:00 AM" "4/12/2016 1:00:00 AM" "4/12/2016 2:00:00 AM" "4/12/2016 3:00:00 AM" ...
    ##  $ StepTotal   : num [1:22099] 373 160 151 0 0 ...
    ##  - attr(*, "spec")=
    ##   .. cols(
    ##   ..   Id = col_double(),
    ##   ..   ActivityHour = col_character(),
    ##   ..   StepTotal = col_double()
    ##   .. )
    ##  - attr(*, "problems")=<externalptr>

    #Convert char to date format

    daily_activity$Date <- as.Date(daily_activity$ActivityDate, "%m/%d/%Y") 
    head(daily_activity)

    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ## 1 1503960366    4/12/2016      13162          8.50            8.50
    ## 2 1503960366    4/13/2016      10735          6.97            6.97
    ## 3 1503960366    4/14/2016      10460          6.74            6.74
    ## 4 1503960366    4/15/2016       9762          6.28            6.28
    ## 5 1503960366    4/16/2016      12669          8.16            8.16
    ## 6 1503960366    4/17/2016       9705          6.48            6.48
    ##   LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance
    ## 1                        0               1.88                     0.55
    ## 2                        0               1.57                     0.69
    ## 3                        0               2.44                     0.40
    ## 4                        0               2.14                     1.26
    ## 5                        0               2.71                     0.41
    ## 6                        0               3.19                     0.78
    ##   LightActiveDistance SedentaryActiveDistance VeryActiveMinutes
    ## 1                6.06                       0                25
    ## 2                4.71                       0                21
    ## 3                3.91                       0                30
    ## 4                2.83                       0                29
    ## 5                5.04                       0                36
    ## 6                2.51                       0                38
    ##   FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories       Date
    ## 1                  13                  328              728     1985 2016-04-12
    ## 2                  19                  217              776     1797 2016-04-13
    ## 3                  11                  181             1218     1776 2016-04-14
    ## 4                  34                  209              726     1745 2016-04-15
    ## 5                  10                  221              773     1863 2016-04-16
    ## 6                  20                  164              539     1728 2016-04-17

    sleep_day$Date<-as.Date(as.POSIXct(sleep_day$SleepDay, format ="%m/%d/%Y %I:%M:%S %p", tz = ""),tz="")
    head(sleep_day)

    ##           Id              SleepDay TotalSleepRecords TotalMinutesAsleep
    ## 1 1503960366 4/12/2016 12:00:00 AM                 1                327
    ## 2 1503960366 4/13/2016 12:00:00 AM                 2                384
    ## 3 1503960366 4/15/2016 12:00:00 AM                 1                412
    ## 4 1503960366 4/16/2016 12:00:00 AM                 2                340
    ## 5 1503960366 4/17/2016 12:00:00 AM                 1                700
    ## 6 1503960366 4/19/2016 12:00:00 AM                 1                304
    ##   TotalTimeInBed       Date
    ## 1            346 2016-04-12
    ## 2            407 2016-04-13
    ## 3            442 2016-04-15
    ## 4            367 2016-04-16
    ## 5            712 2016-04-17
    ## 6            320 2016-04-19

    str(sleep_day)

    ## 'data.frame':    410 obs. of  6 variables:
    ##  $ Id                : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...
    ##  $ SleepDay          : chr  "4/12/2016 12:00:00 AM" "4/13/2016 12:00:00 AM" "4/15/2016 12:00:00 AM" "4/16/2016 12:00:00 AM" ...
    ##  $ TotalSleepRecords : int  1 2 1 2 1 1 1 1 1 1 ...
    ##  $ TotalMinutesAsleep: int  327 384 412 340 700 304 360 325 361 430 ...
    ##  $ TotalTimeInBed    : int  346 407 442 367 712 320 377 364 384 449 ...
    ##  $ Date              : Date, format: "2016-04-12" "2016-04-13" ...

    hourly_steps$ActivityHour<-as.POSIXct(hourly_steps$ActivityHour,format ="%m/%d/%Y %I:%M:%S %p" , tz=Sys.timezone())
    hourly_steps <- hourly_steps %>%
      separate(ActivityHour, into = c("date", "time"), sep= " ") %>%
      mutate(date = ymd(date)) 

    ## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 934 rows [1, 25, 49, 73,
    ## 97, 121, 145, 169, 193, 217, 241, 265, 289, 313, 337, 361, 385, 409, 433, 457,
    ## ...].

    head(hourly_steps)

    ## # A tibble: 6 × 4
    ##           Id date       time     StepTotal
    ##        <dbl> <date>     <chr>        <dbl>
    ## 1 1503960366 2016-04-12 <NA>           373
    ## 2 1503960366 2016-04-12 01:00:00       160
    ## 3 1503960366 2016-04-12 02:00:00       151
    ## 4 1503960366 2016-04-12 03:00:00         0
    ## 5 1503960366 2016-04-12 04:00:00         0
    ## 6 1503960366 2016-04-12 05:00:00         0

    hourly_intensity$ActivityHour<-as.POSIXct(hourly_intensity$ActivityHour,format ="%m/%d/%Y %I:%M:%S %p" , tz=Sys.timezone())
    hourly_intensity <- hourly_intensity %>%
      separate(ActivityHour, into = c("date", "time"), sep= " ") %>%
      mutate(date = ymd(date)) 

    ## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 934 rows [1, 25, 49, 73,
    ## 97, 121, 145, 169, 193, 217, 241, 265, 289, 313, 337, 361, 385, 409, 433, 457,
    ## ...].

    head(hourly_steps)

    ## # A tibble: 6 × 4
    ##           Id date       time     StepTotal
    ##        <dbl> <date>     <chr>        <dbl>
    ## 1 1503960366 2016-04-12 <NA>           373
    ## 2 1503960366 2016-04-12 01:00:00       160
    ## 3 1503960366 2016-04-12 02:00:00       151
    ## 4 1503960366 2016-04-12 03:00:00         0
    ## 5 1503960366 2016-04-12 04:00:00         0
    ## 6 1503960366 2016-04-12 05:00:00         0

### Data analysis

    #Statstical data analysis

    daily_activity %>%
      select(TotalSteps, TotalDistance, SedentaryMinutes, Calories) %>%
      summary()

    ##    TotalSteps    TotalDistance    SedentaryMinutes    Calories   
    ##  Min.   :    0   Min.   : 0.000   Min.   :   0.0   Min.   :   0  
    ##  1st Qu.: 3790   1st Qu.: 2.620   1st Qu.: 729.8   1st Qu.:1828  
    ##  Median : 7406   Median : 5.245   Median :1057.5   Median :2134  
    ##  Mean   : 7638   Mean   : 5.490   Mean   : 991.2   Mean   :2304  
    ##  3rd Qu.:10727   3rd Qu.: 7.713   3rd Qu.:1229.5   3rd Qu.:2793  
    ##  Max.   :36019   Max.   :28.030   Max.   :1440.0   Max.   :4900

    sleep_day %>%
      select(TotalMinutesAsleep,TotalTimeInBed) %>%
      summary() 

    ##  TotalMinutesAsleep TotalTimeInBed 
    ##  Min.   : 58.0      Min.   : 61.0  
    ##  1st Qu.:361.0      1st Qu.:403.8  
    ##  Median :432.5      Median :463.0  
    ##  Mean   :419.2      Mean   :458.5  
    ##  3rd Qu.:490.0      3rd Qu.:526.0  
    ##  Max.   :796.0      Max.   :961.0

    hourly_steps%>%
      select(StepTotal)%>%
      summary()

    ##    StepTotal      
    ##  Min.   :    0.0  
    ##  1st Qu.:    0.0  
    ##  Median :   40.0  
    ##  Mean   :  320.2  
    ##  3rd Qu.:  357.0  
    ##  Max.   :10554.0

Above analysis shows the mean and median for daily\_activity and sleep
data are close to each other, it suggests that the data is relatively
evenly distributed and the data is not heavily influenced by outliers.

Average total steps per day are 7638, which is slightly below the
recommended threshold for achieving health benefits according to various
health organizations and guidelines. Typically, experts recommend aiming
for at least 10,000 steps per day to promote cardiovascular health,
maintain a healthy weight, and improve overall well-being.

Average sleep is recorded as 6.9 hours, meeting the recommended 7-9
hours for optimal well-being and health benefits.

    #Check for number of data collected for each Id

    daily_activity%>% 
      group_by(Id)%>%
      count(Id)

    ## # A tibble: 33 × 2
    ## # Groups:   Id [33]
    ##            Id     n
    ##         <dbl> <int>
    ##  1 1503960366    31
    ##  2 1624580081    31
    ##  3 1644430081    30
    ##  4 1844505072    31
    ##  5 1927972279    31
    ##  6 2022484408    31
    ##  7 2026352035    31
    ##  8 2320127002    31
    ##  9 2347167796    18
    ## 10 2873212765    31
    ## # ℹ 23 more rows

    sleep_day%>% 
      group_by(Id)%>%
      count(Id)

    ## # A tibble: 24 × 2
    ## # Groups:   Id [24]
    ##            Id     n
    ##         <dbl> <int>
    ##  1 1503960366    25
    ##  2 1644430081     4
    ##  3 1844505072     3
    ##  4 1927972279     5
    ##  5 2026352035    28
    ##  6 2320127002     1
    ##  7 2347167796    15
    ##  8 3977333714    28
    ##  9 4020332650     8
    ## 10 4319703577    26
    ## # ℹ 14 more rows

Above analysis shows that the number of sleep data collected for each ID
is different, which means that there is variability in the frequency of
sleep data recordings among the individual IDs.

The differences in the frequency of sleep data recordings among
different IDs can potentially lead to bias in the analysis. If certain
individuals are more diligent or consistent in recording their sleep
data compared to others, it may introduce a systematic error in the
findings, skewing the results towards the habits of the more frequent
recorders. This bias can impact the applicability and reliability of the
study’s conclusions.

    #Adding a weekday column

    head(daily_activity)

    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ## 1 1503960366    4/12/2016      13162          8.50            8.50
    ## 2 1503960366    4/13/2016      10735          6.97            6.97
    ## 3 1503960366    4/14/2016      10460          6.74            6.74
    ## 4 1503960366    4/15/2016       9762          6.28            6.28
    ## 5 1503960366    4/16/2016      12669          8.16            8.16
    ## 6 1503960366    4/17/2016       9705          6.48            6.48
    ##   LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance
    ## 1                        0               1.88                     0.55
    ## 2                        0               1.57                     0.69
    ## 3                        0               2.44                     0.40
    ## 4                        0               2.14                     1.26
    ## 5                        0               2.71                     0.41
    ## 6                        0               3.19                     0.78
    ##   LightActiveDistance SedentaryActiveDistance VeryActiveMinutes
    ## 1                6.06                       0                25
    ## 2                4.71                       0                21
    ## 3                3.91                       0                30
    ## 4                2.83                       0                29
    ## 5                5.04                       0                36
    ## 6                2.51                       0                38
    ##   FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories       Date
    ## 1                  13                  328              728     1985 2016-04-12
    ## 2                  19                  217              776     1797 2016-04-13
    ## 3                  11                  181             1218     1776 2016-04-14
    ## 4                  34                  209              726     1745 2016-04-15
    ## 5                  10                  221              773     1863 2016-04-16
    ## 6                  20                  164              539     1728 2016-04-17

    daily_activity$Weekday<-wday(daily_activity$Date, week_start=1,label=TRUE, abbr=FALSE) 
    #daily_activity <- daily_activity[ ,c(1:2,16,3:15)]
    view(daily_activity)

    #Relation between Total steps taken and calories burned

    cor(daily_activity$TotalSteps, daily_activity$Calories, method = "pearson")

    ## [1] 0.5915681

    ggplot(data=daily_activity) + 
      geom_point(mapping= aes(x=TotalSteps, y=Calories, color=TotalSteps))+
                   theme(panel.background = element_blank())+
      labs(title="Relation between total steps taken and calories burned")

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/figure-markdown_github/Relation%20between%20Total%20steps%20taken%20and%20calories%20burned-1.png)

There is a clear positive correlation observed between Total Steps and
Calories, underscoring the intuitive connection that as physical
activity increases, so does the calorie expenditure – a direct
reflection of the principle that higher activity levels result in
greater calorie burn.

Now, lets see the avaerage steps taken hourly

    #Average steps taken hourly

    view(hourly_steps)
    hourly_steps %>%
      group_by(time) %>%
      summarize(average_steps = mean(StepTotal)) %>%
      ggplot() +
      geom_col(mapping = aes(x=time, y = average_steps, fill = average_steps)) + 
      theme(panel.background = element_blank())+
      labs(title = "Average steps taken hourly", x="", y="") + 
      scale_fill_gradient(low = "#A9CCF6", high = "#2B6796")+
      theme(axis.text.x = element_text(angle = 90))

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/Average%20steps%20taken%20hourly-1.png)

After examining the hourly distribution of Total Intensity, it became
evident that individuals tend to be more active from 8 am to 2 pm.The
peak of activity is notably between 4 pm and 7 pm, suggesting that
individuals might engage in physical activities such as going to the gym
or taking a walk after completing their workday. This analysis can be
used by the Bellabeat app to prompt and motivate users to participate in
a run or walk.

Now lets visualize which week day is the most active day

    #Average steps taken in weekdays

    steps_per_week <- daily_activity %>% 
      group_by(Weekday) %>% 
      summarize(Total=mean(TotalSteps))
    view(steps_per_week)
    ggplot(data=steps_per_week) + 
      geom_col(mapping= aes(x=Weekday, y=Total, fill=Total))+
      theme(panel.background = element_blank())+
      scale_fill_gradient(low = "#A9CCF6", high = "#2B6796")+
      labs(title="Average steps taken in weekdays")

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/Average%20steps%20taken%20in%20weekdays-1.png)

The analysis indicates that the highest number of steps were recorded on
Monday, Tuesday, and Saturday. This suggests that individuals are
generally more physically active on these specific days compared to the
rest of the week.

    #Mean activity minutes based on weekdays

    activity <- daily_activity %>%
      select(VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes,Weekday)%>%
      gather(key = "Activity_level", value = "minutes", -Weekday)
    View(activity)

    # Create a bar plot with mean values
    ggplot(activity, aes(x = Weekday, y = minutes, fill = Activity_level)) +
      geom_bar(stat = "summary", fun = "mean") +
      theme(panel.background = element_blank())+
      labs(title = "Mean activity minutes based on weekdays",
           x = "Weekdays", y = "Mean Minutes") +
      scale_fill_manual(values = c("VeryActiveMinutes" = "#2B6796", "FairlyActiveMinutes" = "yellow", "LightlyActiveMinutes" = "pink", "SedentaryMinutes"="#A9CCF6"))

![]()https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/Mean%20activity%20minutes%20based%20on%20weekdays-1.png
The analysis indicates that individuals tend to be more sedentary on
Thursdays compared to the rest of the week. This could be attributed to
various factors such as work schedules, fatigue, or specific activities
that dominate Thursdays in a way that limits physical activity.

Now lets analyse

    #Average active minutes

    mean_activity <- activity %>%
      group_by(Activity_level) %>%
      summarise(mean_minutes = mean(minutes, na.rm = TRUE))
    head(mean_activity)

    ## # A tibble: 4 × 2
    ##   Activity_level       mean_minutes
    ##   <chr>                       <dbl>
    ## 1 FairlyActiveMinutes          13.6
    ## 2 LightlyActiveMinutes        193. 
    ## 3 SedentaryMinutes            991. 
    ## 4 VeryActiveMinutes            21.2

    colors<-c("yellow","pink","#2B6796","#A9CCF6")
    fig <- plot_ly(mean_activity, labels = ~Activity_level, values = ~mean_minutes, type = 'pie',marker = list(colors = colors))
    fig <- fig %>% layout(title = 'Average active minutes')
    fig

<div class="plotly html-widget html-fill-item" id="htmlwidget-dd16ba022de1a044293c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-dd16ba022de1a044293c">{"x":{"visdat":{"40ec471b4ab5":["function () ","plotlyVisDat"]},"cur_data":"40ec471b4ab5","attrs":{"40ec471b4ab5":{"labels":{},"values":{},"marker":{"colors":["yellow","pink","#2B6796","#A9CCF6"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average active minutes","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["FairlyActiveMinutes","LightlyActiveMinutes","SedentaryMinutes","VeryActiveMinutes"],"values":[13.564893617021276,192.8127659574468,991.21063829787238,21.164893617021278],"marker":{"color":"rgba(31,119,180,1)","colors":["yellow","pink","#2B6796","#A9CCF6"],"line":{"color":"rgba(255,255,255,1)"}},"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

Out of the total active minutes, 81% are sedentary, 15% are lightly
active, 1.7% are very active minutes, and 1.1% are fairly active
minutes. This distribution indicates that the majority of the recorded
activity is sedentary, with a smaller proportion allocated to light,
very active, and fairly active categories.

Lets analyse sleep factor and see if there is any relation between
active minutes and minutes asleep

    #Merging the sleep and daily activity data

    merged_data <- merge(sleep_day, daily_activity, by=c('Id', 'Date'))
    head(merged_data)

    ##           Id       Date              SleepDay TotalSleepRecords
    ## 1 1503960366 2016-04-12 4/12/2016 12:00:00 AM                 1
    ## 2 1503960366 2016-04-13 4/13/2016 12:00:00 AM                 2
    ## 3 1503960366 2016-04-15 4/15/2016 12:00:00 AM                 1
    ## 4 1503960366 2016-04-16 4/16/2016 12:00:00 AM                 2
    ## 5 1503960366 2016-04-17 4/17/2016 12:00:00 AM                 1
    ## 6 1503960366 2016-04-19 4/19/2016 12:00:00 AM                 1
    ##   TotalMinutesAsleep TotalTimeInBed ActivityDate TotalSteps TotalDistance
    ## 1                327            346    4/12/2016      13162          8.50
    ## 2                384            407    4/13/2016      10735          6.97
    ## 3                412            442    4/15/2016       9762          6.28
    ## 4                340            367    4/16/2016      12669          8.16
    ## 5                700            712    4/17/2016       9705          6.48
    ## 6                304            320    4/19/2016      15506          9.88
    ##   TrackerDistance LoggedActivitiesDistance VeryActiveDistance
    ## 1            8.50                        0               1.88
    ## 2            6.97                        0               1.57
    ## 3            6.28                        0               2.14
    ## 4            8.16                        0               2.71
    ## 5            6.48                        0               3.19
    ## 6            9.88                        0               3.53
    ##   ModeratelyActiveDistance LightActiveDistance SedentaryActiveDistance
    ## 1                     0.55                6.06                       0
    ## 2                     0.69                4.71                       0
    ## 3                     1.26                2.83                       0
    ## 4                     0.41                5.04                       0
    ## 5                     0.78                2.51                       0
    ## 6                     1.32                5.03                       0
    ##   VeryActiveMinutes FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes
    ## 1                25                  13                  328              728
    ## 2                21                  19                  217              776
    ## 3                29                  34                  209              726
    ## 4                36                  10                  221              773
    ## 5                38                  20                  164              539
    ## 6                50                  31                  264              775
    ##   Calories   Weekday
    ## 1     1985   Tuesday
    ## 2     1797 Wednesday
    ## 3     1745    Friday
    ## 4     1863  Saturday
    ## 5     1728    Sunday
    ## 6     2035   Tuesday

    #Relation between Active minutes and Minutes asleep

    plot_very_active <- ggplot(data=merged_data, aes(x=SedentaryMinutes, y=TotalMinutesAsleep)) + 
      geom_point(color='#2B6796', alpha = 0.7)+
      geom_smooth(color="red") +
      labs(title="Sedentary minutes vs Minutes asleep",
           x = "Fairly Active Minutes",
           y = "Minutes Asleep") +
      theme_minimal()


    plot_fairly_active <- ggplot(merged_data, aes(x = FairlyActiveMinutes, y = TotalMinutesAsleep)) +
      geom_point(color = "#2B6796", alpha = 0.7) +
      geom_smooth(method = "loess",color="red") +
      labs(title = "Fairly minutes vs Minutes asleep",
           x = "Fairly Active Minutes",
           y = "Minutes Asleep") +
      theme_minimal()


    plot_lightly_active <- ggplot(merged_data, aes(x = LightlyActiveMinutes, y = TotalMinutesAsleep)) +
      geom_point(color = "#2B6796", alpha = 0.7) +
      geom_smooth(method = "loess",color="red") +
      labs(title = "Lightly Active minutes vs Minutes asleep",
           x = "Lightly Active Minutes",
           y = "Minutes Asleep") +
      theme_minimal()


    plot_sedentary <- ggplot(merged_data, aes(x = SedentaryMinutes, y = TotalMinutesAsleep)) +
      geom_point(color = "#2B6796", alpha = 0.7) +
      geom_smooth(method = "loess",color="red") +
      labs(title = "Sedentary minutes vs Minutes asleep",
           x = "Sedentary Minutes",
           y = "Minutes Asleep") +
      theme_minimal()

    ggarrange(plot_very_active, plot_fairly_active, plot_lightly_active, plot_sedentary,
              ncol = 2, nrow = 2, common.legend = TRUE, legend = "right")

    ## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
    ## `geom_smooth()` using formula = 'y ~ x'
    ## `geom_smooth()` using formula = 'y ~ x'
    ## `geom_smooth()` using formula = 'y ~ x'
    ## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
    ## `geom_smooth()` using formula = 'y ~ x'
    ## `geom_smooth()` using formula = 'y ~ x'
    ## `geom_smooth()` using formula = 'y ~ x'

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/Relation%20between%20Active%20minutes%20and%20Minutes%20asleep-1.png)
Above observation from the data of the given user indicate that there is
no apparent positive relation between active minutes, such as very
active, sedentary, fairly active, and minutes asleep. The data suggests
that the duration of physical activity in specific categories is not
consistently associated with the duration of sleep for this particular
user.

Visualizing the relation between steps taken and minutes assleep

    #Relation between Steps taken and Minutes asleep

    ggplot(data=merged_data, aes(x=TotalMinutesAsleep, y=TotalSteps)) + 
      theme(panel.background = element_blank())+
      geom_point(color='#2B6796')+
      geom_smooth(color="red")

    ## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/Relation%20between%20Steps%20taken%20and%20Minutes%20asleep-1.png)

      labs(title="Minutes Asleep vs. Sedentary Minutes")

    ## $title
    ## [1] "Minutes Asleep vs. Sedentary Minutes"
    ## 
    ## attr(,"class")
    ## [1] "labels"

There is no apparent relation between the total steps taken and the
duration of minutes asleep. This may be because factors other than daily
physical activity, such as sleep quality, sleep environment, or
individual sleep patterns, play a more significant role in determining
the total duration of sleep.

Checking the relation between total time in bed and time taken to sleep

    #Relation between total time in bed and time taken to sleep

    merged_data$TimeTakenSleep<- merged_data$TotalTimeInBed-merged_data$TotalMinutesAsleep
    view(merged_data)
    ggplot(merged_data, aes(x =TotalSteps, y =  TimeTakenSleep)) +
      geom_point(color = "#2B6796", alpha = 0.7) +
      theme(panel.background = element_blank())+
      geom_smooth(color="red")

    ## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'

![](https://github.com/Himi26/Fitness-Tracker-Data-Analysis-using-R/blob/main/graphs/Relation%20between%20total%20time%20in%20bed%20and%20time%20taken%20to%20sleep-1.png)

      labs(title = "Relationship between total steps taken and time taken to sleep") +
      theme_minimal()

    ## NULL

There is no relation between the total time spent in bed and the time
taken to fall asleep.

### Summary

The analysis of the provided data reveals several key findings:

Activity Patterns: Users tend to be more active between 5 am and 10 pm,
with a peak in activity observed between 5 pm and 7 pm. The highest
number of steps is recorded on Monday, Tuesday, and Saturday.

Sedentary Behavior: Sedentary behavior is notably higher on Thursdays
compared to other days of the week.

Activity Distribution: Of the total average active minutes, 81% are
sedentary, 15% are lightly active, 1.7% are very active, and 1.1% are
fairly active.

Relation Between Variables: There is no clear positive relation observed
among different activity levels (very active, sedentary, fairly active,
lightly active). No apparent relation exists between total steps and
time taken to fall asleep. There is no clear relation between total
steps and minutes asleep. Total time in bed does not seem to influence
the time taken to fall asleep.

Sleep and Activity Patterns: Sleep duration and activity levels appear
to be relatively independent, with no clear relation observed in the
provided data.

Overall, these findings highlight the need for targeted strategies to
promote physical activity, address sedentary behavior, and enhance
overall health and well-being among users of the Bellabeat app

### Recomendations

Promote Breaks and Movement: Encourage users to take short breaks
throughout the day, incorporating light physical activity or stretching.
Provide reminders in the Bellabeat app to stand up, walk around, or
perform quick exercises to break up long periods of sedentary behavior.

Set Daily Activity Goals: Establish achievable daily activity goals
tailored to individual fitness levels. Users can track their progress
and receive positive reinforcement when reaching or exceeding these
goals, fostering motivation to be more active.

Incorporate Variety in Workouts: Offer diverse workout options within
the app, including activities that cater to different preferences and
fitness levels. This can include walking, jogging, yoga, or other
exercises that appeal to a broad user base.

Community Challenges: Create community-based challenges or competitions
within the Bellabeat app to engage users in friendly competitions,
fostering a sense of community and motivation to increase physical
activity.

Educational Content: Provide educational content within the app about
the health benefits of reducing sedentary behavior and the importance of
incorporating regular physical activity into daily routines.

Personalized Recommendations: Leverage user data to offer personalized
recommendations for activities based on individual preferences, fitness
levels, and schedules. Tailored suggestions can enhance engagement and
adherence to a more active lifestyle.

Incorporate Gamification: Introduce gamification elements, such as
rewards, badges, or virtual challenges, to make the process of becoming
more active enjoyable and engaging for users.

Utilize Wearable Device Features: If applicable, leverage features of
wearable devices to track and provide real-time feedback on activity
levels. This integration can enhance the user experience and provide
continuous motivation.
