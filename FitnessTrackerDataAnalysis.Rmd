---
output: html_document
---
## Fitness Tracker Usage Analysis with R

![ ](C:/Users/ihimi/Downloads/download.jpg)



### Introduction

Bellabeat, a high-tech manufacturer of health-focusedproducts for women. Collecting data on activity, sleep, stress, and reproductive health has allowed Bellabeat to empower women with knowledge about their own health and habits. 

Bellabeat offers health-focused products for women like Bellabeat app, Leaf, Time, Spring and Bellabeat membership. This case study focus on one of Bellabeat’s products i.e. the Bellabeat app, which provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and
make healthy decisions. The Bellabeat app connects to its line of smart wellness products.

Analysing non-Bellabeat smart device data can help to gain insight into how consumers are using their smart devices. The insights discovered and recommendations will help guide marketing strategy for the company. 

### Business task

To analyses smart device data to gain insight into how consumers are using their smart devices focused on one of Bellabeat’s products i.e. Bellabeat App . This analysis focus to answer the key business questions like:

1. What are some trends in smart device usage?
2. How could these trends apply to Bellabeat customers?
3. How could these trends help influence Bellabeat marketing strategy?

### Data Description 

In this case study Public data  from Kaggle called FitBit Fitness Tracker Data that explores smart device users’ daily habits is used. These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. 

This Kaggle dataset comprises personal fitness tracker data from thirty Fitbit users who shared minute-level information on physical activity, heart rate, and sleep monitoring. The dataset encompasses details about daily activity, steps, and heart rate, providing an opportunity to delve into users' habits.

#### Installing the package and load the libraries
```{r Install and Load library}
#Install and Load library

#install.packages('cowplot')
#install.packages("plotly")
#install.packages("vroom")
#install.packages(c("ggplot2", "ggpubr"))
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(lubridate)
library(cowplot)
library(dplyr)
library(plotly)
library(vroom)

```

#### Loading the dataset
```{r Read csv file and load to dataframe}
#Read csv file and load to dataframe

daily_activity <- read.csv("dailyActivity_merged.csv")
sleep_day <- read.csv("sleepDay_merged.csv")
weight_log <- read.csv("weightLogInfo_merged.csv")
daily_calories <- read_csv("dailyCalories_merged.csv")
daily_intensities <- read_csv("dailyIntensities_merged.csv")
daily_steps <- read_csv("dailySteps_merged.csv")
hourly_calories <- read_csv("hourlyCalories_merged.csv")
hourly_intensity <- read_csv("hourlyIntensities_merged.csv")
hourly_steps <- read_csv("hourlySteps_merged.csv")
heart_rate_data <- read_csv("heartrate_seconds_merged.csv")
minute_calories_long <- read_csv("minuteCaloriesNarrow_merged.csv")
minute_calories_wide <- read_csv("minuteCaloriesWide_merged.csv")
minute_intensities_long <- read_csv("minuteIntensitiesNarrow_merged.csv")
minute_intensities_wide <- read_csv("minuteIntensitiesWide_merged.csv")
minute_METs <- read_csv("minuteMETsNarrow_merged.csv")
minute_sleep <- read_csv("minuteSleep_merged.csv")
minute_steps_long <- read_csv("minuteStepsNarrow_merged.csv")
minute_steps_wide <- read_csv("minuteStepsWide_merged.csv")
```
### Data Review

```{r Preview of the dataframe }
#Preview of the dataframe

head(daily_activity)
head(sleep_day)
head(weight_log)
head(daily_calories)
head(daily_intensities)
head(daily_steps)
head(hourly_calories)
head(hourly_intensity)
head(hourly_steps)
head(heart_rate_data)
head(minute_calories_long )
head(minute_calories_wide )
head(minute_intensities_long )
head(minute_intensities_wide )
head(minute_METs )
head(minute_sleep )
head(minute_steps_long )
head(minute_steps_wide )

```


```{r Check for number of rows in each dataframe }
#Check for number of rows in each dataframe

nrow(daily_activity)
nrow(sleep_day)
nrow(weight_log)
nrow(daily_calories)
nrow(daily_intensities)
nrow(daily_steps)
nrow(hourly_calories)
nrow(hourly_intensity)
nrow(hourly_steps)
nrow(heart_rate_data)
nrow(minute_calories_long )
nrow(minute_calories_wide )
nrow(minute_intensities_long )
nrow(minute_intensities_wide )
nrow(minute_METs )
nrow(minute_sleep )
nrow(minute_steps_long )
nrow(minute_steps_wide )

```

```{r Check for number of unique users in each dataframe or dataset}
#Check for number of unique users in each dataframe or dataset

n_distinct(daily_activity$Id)
n_distinct(sleep_day$Id)
n_distinct(weight_log$Id)
n_distinct(daily_calories$Id)
n_distinct(daily_intensities$Id)
n_distinct(daily_steps$Id)
n_distinct(hourly_calories$Id)
n_distinct(hourly_intensity$Id)
n_distinct(hourly_steps$Id)
n_distinct(heart_rate_data$Id)
n_distinct(minute_calories_long$Id)
n_distinct(minute_calories_wide$Id)
n_distinct(minute_intensities_long$Id)
n_distinct(minute_intensities_wide$Id)
n_distinct(minute_METs$Id)
n_distinct(minute_sleep$Id)
n_distinct(minute_steps_long$Id)
n_distinct(minute_steps_wide$Id)

```
After After reviewing the dataset, the following observations can be made: 

The dataset contains more users' data for daily activity compared to sleep data.

Weight and heart rate data have a lower representation with only 8 and 14 users, respectively, compared to the  daily activity data. Drawing comparisons with other data categories may introduce bias. so, we will have to exclude this for further analysis.

The data for minutes, including calories, intensity, and sleep, as well as hourly calories, intensity, and sleep, have been merged into daily records for calories, intensity, and sleep. 

Subsequently, all the daily data has been merged into a single daily activity table.As a result, detailed minute-level data and individual daily data is not required. However, for subsequent analysis, we will retain the need for hourly steps and intensity data.

The absence of demographic information, such as gender and age, in a limited dataset of 30 users raises concerns about potential sampling bias. It becomes uncertain if the sample accurately represents the entire population.


### Data Cleaning

```{r Checking for null value}
#Checking for null value

is.null(daily_activity)
is.null(sleep_day)
is.null(hourly_intensity)
is.null(hourly_steps)

```

```{r Checking for duplicate value}
#Checking for duplicate value

sum(duplicated(daily_activity))
sum(duplicated(sleep_day))
sum(duplicated(hourly_intensity))
sum(duplicated(hourly_steps))

```

```{r Remove duplicate values}
#Remove duplicate values

sleep_day <- sleep_day %>% distinct()

```

```{r Preview dataframe}
#Preview dataframe

head(daily_activity)
str(daily_activity)

head(sleep_day)
str(sleep_day)

head(hourly_steps)
str(hourly_steps)

```

```{r Convert char to date format}
#Convert char to date format

daily_activity$Date <- as.Date(daily_activity$ActivityDate, "%m/%d/%Y") 
head(daily_activity)
```

```{r}
sleep_day$Date<-as.Date(as.POSIXct(sleep_day$SleepDay, format ="%m/%d/%Y %I:%M:%S %p", tz = ""),tz="")
head(sleep_day)
str(sleep_day)

```
```{r}
hourly_steps$ActivityHour<-as.POSIXct(hourly_steps$ActivityHour,format ="%m/%d/%Y %I:%M:%S %p" , tz=Sys.timezone())
hourly_steps <- hourly_steps %>%
  separate(ActivityHour, into = c("date", "time"), sep= " ") %>%
  mutate(date = ymd(date)) 

head(hourly_steps)
```
```{r}
hourly_intensity$ActivityHour<-as.POSIXct(hourly_intensity$ActivityHour,format ="%m/%d/%Y %I:%M:%S %p" , tz=Sys.timezone())
hourly_intensity <- hourly_intensity %>%
  separate(ActivityHour, into = c("date", "time"), sep= " ") %>%
  mutate(date = ymd(date)) 

head(hourly_steps)
```
### Data analysis
```{r Statstical data analysis}
#Statstical data analysis

daily_activity %>%
  select(TotalSteps, TotalDistance, SedentaryMinutes, Calories) %>%
  summary()

sleep_day %>%
  select(TotalMinutesAsleep,TotalTimeInBed) %>%
  summary() 

hourly_steps%>%
  select(StepTotal)%>%
  summary()

```
Above analysis shows  the mean and median for daily_activity and sleep data are close to each other, it suggests that the data is relatively evenly distributed and  the data is not heavily influenced by outliers.

Average total steps per day are 7638, which is slightly below the recommended threshold for achieving health benefits according to various health organizations and guidelines. Typically, experts recommend aiming for at least 10,000 steps per day to promote cardiovascular health, maintain a healthy weight, and improve overall well-being.

Average sleep is recorded as 6.9 hours, meeting the recommended 7-9 hours for optimal well-being and health benefits.



```{r Check for number of data collected for each Id}
#Check for number of data collected for each Id

daily_activity%>% 
  group_by(Id)%>%
  count(Id)

```

```{r}
sleep_day%>% 
  group_by(Id)%>%
  count(Id)
```
Above analysis shows that the number of sleep data collected for each ID is different, which means that there is variability in the frequency of sleep data recordings among the individual IDs. 

The differences in the frequency of sleep data recordings among different IDs can potentially lead to bias in the analysis. If certain individuals are more diligent or consistent in recording their sleep data compared to others, it may introduce a systematic error in the findings, skewing the results towards the habits of the more frequent recorders. This bias can impact the applicability and reliability of the study's conclusions.


```{r Adding a weekday column}
#Adding a weekday column

head(daily_activity)
daily_activity$Weekday<-wday(daily_activity$Date, week_start=1,label=TRUE, abbr=FALSE) 
#daily_activity <- daily_activity[ ,c(1:2,16,3:15)]
view(daily_activity)

```





```{r Relation between Total steps taken and calories burned}
#Relation between Total steps taken and calories burned

cor(daily_activity$TotalSteps, daily_activity$Calories, method = "pearson")
ggplot(data=daily_activity) + 
  geom_point(mapping= aes(x=TotalSteps, y=Calories, color=TotalSteps))+
               theme(panel.background = element_blank())+
  labs(title="Relation between total steps taken and calories burned")
```

There is a clear positive correlation observed between Total Steps and Calories, underscoring the intuitive connection that as physical activity increases, so does the calorie expenditure – a direct reflection of the principle that higher activity levels result in greater calorie burn.

Now, lets see the avaerage steps taken hourly

```{r Average steps taken hourly}
#Average steps taken hourly

view(hourly_steps)
hourly_steps %>%
  group_by(time) %>%
  summarize(average_steps = mean(StepTotal)) %>%
  ggplot() +
  geom_col(mapping = aes(x=time, y = average_steps, fill = average_steps)) + 
  theme(panel.background = element_blank())+
  labs(title = "Average steps taken hourly", x="", y="") + 
  scale_fill_gradient(low = "#A9CCF6", high = "#2B6796")+
  theme(axis.text.x = element_text(angle = 90))
  
  
```

After examining the hourly distribution of Total Intensity, it became evident that individuals tend to be more active from 8 am to 2 pm.The peak of activity is notably between 4 pm and 7 pm, suggesting that individuals might engage in physical activities such as going to the gym or taking a walk after completing their workday. This analysis can be used by the Bellabeat app to prompt and motivate users to participate in a run or walk.

Now lets visualize which week day is the most active day

```{r Average steps taken in weekdays}
#Average steps taken in weekdays

steps_per_week <- daily_activity %>% 
  group_by(Weekday) %>% 
  summarize(Total=mean(TotalSteps))
view(steps_per_week)
ggplot(data=steps_per_week) + 
  geom_col(mapping= aes(x=Weekday, y=Total, fill=Total))+
  theme(panel.background = element_blank())+
  scale_fill_gradient(low = "#A9CCF6", high = "#2B6796")+
  labs(title="Average steps taken in weekdays")
  

```

The analysis indicates that the highest number of steps were recorded on Monday, Tuesday, and Saturday. This suggests that individuals are generally more physically active on these specific days compared to the rest of the week.   

```{r Mean activity minutes based on weekdays}
#Mean activity minutes based on weekdays

activity <- daily_activity %>%
  select(VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes,Weekday)%>%
  gather(key = "Activity_level", value = "minutes", -Weekday)
View(activity)

# Create a bar plot with mean values
ggplot(activity, aes(x = Weekday, y = minutes, fill = Activity_level)) +
  geom_bar(stat = "summary", fun = "mean") +
  theme(panel.background = element_blank())+
  labs(title = "Mean activity minutes based on weekdays",
       x = "Weekdays", y = "Mean Minutes") +
  scale_fill_manual(values = c("VeryActiveMinutes" = "#2B6796", "FairlyActiveMinutes" = "yellow", "LightlyActiveMinutes" = "pink", "SedentaryMinutes"="#A9CCF6"))
```
The analysis indicates that individuals tend to be more sedentary on Thursdays compared to the rest of the week. This could be attributed to various factors such as work schedules, fatigue, or specific activities that dominate Thursdays in a way that limits physical activity.  

Now lets analyse 
```{r Average active minutes}
#Average active minutes

mean_activity <- activity %>%
  group_by(Activity_level) %>%
  summarise(mean_minutes = mean(minutes, na.rm = TRUE))
head(mean_activity)
colors<-c("yellow","pink","#2B6796","#A9CCF6")
fig <- plot_ly(mean_activity, labels = ~Activity_level, values = ~mean_minutes, type = 'pie',marker = list(colors = colors))
fig <- fig %>% layout(title = 'Average active minutes',width = 700, height = 700)
fig
  

```
Out of the total active minutes, 81% are sedentary, 15% are lightly active, 1.7% are very active minutes, and 1.1% are fairly active minutes. This distribution indicates that the majority of the recorded activity is sedentary, with a smaller proportion allocated to light, very active, and fairly active categories.

Lets analyse sleep factor and see if there is any relation between active minutes and minutes asleep

```{r Merging the sleep and daily activity data}
#Merging the sleep and daily activity data

merged_data <- merge(sleep_day, daily_activity, by=c('Id', 'Date'))
head(merged_data)
```

```{r Relation between Active minutes and Minutes asleep}
#Relation between Active minutes and Minutes asleep

plot_very_active <- ggplot(data=merged_data, aes(x=SedentaryMinutes, y=TotalMinutesAsleep)) + 
  geom_point(color='#2B6796', alpha = 0.7)+
  geom_smooth(color="red") +
  labs(title="Sedentary minutes vs Minutes asleep",
       x = "Fairly Active Minutes",
       y = "Minutes Asleep") +
  theme_minimal()


plot_fairly_active <- ggplot(merged_data, aes(x = FairlyActiveMinutes, y = TotalMinutesAsleep)) +
  geom_point(color = "#2B6796", alpha = 0.7) +
  geom_smooth(method = "loess",color="red") +
  labs(title = "Fairly minutes vs Minutes asleep",
       x = "Fairly Active Minutes",
       y = "Minutes Asleep") +
  theme_minimal()


plot_lightly_active <- ggplot(merged_data, aes(x = LightlyActiveMinutes, y = TotalMinutesAsleep)) +
  geom_point(color = "#2B6796", alpha = 0.7) +
  geom_smooth(method = "loess",color="red") +
  labs(title = "Lightly Active minutes vs Minutes asleep",
       x = "Lightly Active Minutes",
       y = "Minutes Asleep") +
  theme_minimal()


plot_sedentary <- ggplot(merged_data, aes(x = SedentaryMinutes, y = TotalMinutesAsleep)) +
  geom_point(color = "#2B6796", alpha = 0.7) +
  geom_smooth(method = "loess",color="red") +
  labs(title = "Sedentary minutes vs Minutes asleep",
       x = "Sedentary Minutes",
       y = "Minutes Asleep") +
  theme_minimal()

ggarrange(plot_very_active, plot_fairly_active, plot_lightly_active, plot_sedentary,
          ncol = 2, nrow = 2, common.legend = TRUE, legend = "right")
```
Above observation from the data of the given user indicate that there is no apparent positive relation between active minutes, such as very active, sedentary, fairly active, and minutes asleep. The data suggests that the duration of physical activity in specific categories is not consistently associated with the duration of sleep for this particular user.



Visualizing the relation between steps taken and minutes assleep

```{r Relation between Steps taken and Minutes asleep}
#Relation between Steps taken and Minutes asleep

ggplot(data=merged_data, aes(x=TotalMinutesAsleep, y=TotalSteps)) + 
  theme(panel.background = element_blank())+
  geom_point(color='#2B6796')+
  geom_smooth(color="red")
  labs(title="Minutes Asleep vs. Sedentary Minutes")
```

There is no apparent relation between the total steps taken and the duration of minutes asleep. This may be because factors other than daily physical activity, such as sleep quality, sleep environment, or individual sleep patterns, play a more significant role in determining the total duration of sleep. 

Checking the relation between total time in bed and time taken to sleep

```{r Relation between total time in bed and time taken to sleep}
#Relation between total time in bed and time taken to sleep

merged_data$TimeTakenSleep<- merged_data$TotalTimeInBed-merged_data$TotalMinutesAsleep
view(merged_data)
ggplot(merged_data, aes(x =TotalSteps, y =  TimeTakenSleep)) +
  geom_point(color = "#2B6796", alpha = 0.7) +
  theme(panel.background = element_blank())+
  geom_smooth(color="red")
  labs(title = "Relationship between total steps taken and time taken to sleep") +
  theme_minimal()
```
There is no relation between the total time spent in bed and the time taken to fall asleep.

### Summary

The analysis of the provided data reveals several key findings:

Activity Patterns:
Users tend to be more active between 5 am and 10 pm, with a peak in activity observed between 5 pm and 7 pm.
The highest number of steps is recorded on Monday, Tuesday, and Saturday.

Sedentary Behavior:
Sedentary behavior is notably higher on Thursdays compared to other days of the week.

Activity Distribution:
Of the total average active minutes, 81% are sedentary, 15% are lightly active, 1.7% are very active, and 1.1% are fairly active.

Relation Between Variables:
There is no clear positive relation observed among different activity levels (very active, sedentary, fairly active, lightly active).
No apparent relation exists between total steps and time taken to fall asleep.
There is no clear relation between total steps and minutes asleep.
Total time in bed does not seem to influence the time taken to fall asleep.

Sleep and Activity Patterns:
Sleep duration and activity levels appear to be relatively independent, with no clear relation observed in the provided data.

Overall, these findings highlight the need for targeted strategies to promote physical activity, address sedentary behavior, and enhance overall health and well-being among users of the Bellabeat app

### Recomendations

Promote Breaks and Movement:
Encourage users to take short breaks throughout the day, incorporating light physical activity or stretching. Provide reminders in the Bellabeat app to stand up, walk around, or perform quick exercises to break up long periods of sedentary behavior.

Set Daily Activity Goals:
Establish achievable daily activity goals tailored to individual fitness levels. Users can track their progress and receive positive reinforcement when reaching or exceeding these goals, fostering motivation to be more active.

Incorporate Variety in Workouts:
Offer diverse workout options within the app, including activities that cater to different preferences and fitness levels. This can include walking, jogging, yoga, or other exercises that appeal to a broad user base.

Community Challenges:
Create community-based challenges or competitions within the Bellabeat app to engage users in friendly competitions, fostering a sense of community and motivation to increase physical activity.

Educational Content:
Provide educational content within the app about the health benefits of reducing sedentary behavior and the importance of incorporating regular physical activity into daily routines.

Personalized Recommendations:
Leverage user data to offer personalized recommendations for activities based on individual preferences, fitness levels, and schedules. Tailored suggestions can enhance engagement and adherence to a more active lifestyle.

Incorporate Gamification:
Introduce gamification elements, such as rewards, badges, or virtual challenges, to make the process of becoming more active enjoyable and engaging for users.

Utilize Wearable Device Features:
If applicable, leverage features of wearable devices to track and provide real-time feedback on activity levels. This integration can enhance the user experience and provide continuous motivation.



